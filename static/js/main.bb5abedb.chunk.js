(this["webpackJsonpproject-bg"]=this["webpackJsonpproject-bg"]||[]).push([[0],[,,,,,,,,function(e,n,t){},function(e,n,t){},,,,,,,function(e,n,t){},,,function(e,n,t){},function(e,n,t){},,,,,,function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=26},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var a=t(1),r=t(10),c=t.n(r),u=t(2),l=t(5),o=(t(16),t(0)),i=function(e){e.gamePhase;return Object(o.jsx)("div",{id:"bg",children:Object(o.jsx)("div",{className:"noise"})})};i.defaultProps={gamePhase:null};var s=i,d=t(3),b=t.n(d),j=t(4),p=(t(19),function(e){var n=e.text,t=e.icon,a=e.onClick,r=e.disabled;return Object(o.jsxs)("button",{className:"simple-button"+(r?" disabled":""),type:"button",onClick:a,children:[t&&Object(o.jsx)("span",{className:"material-icons-round",children:t}),n&&n]})});p.defaultProps={text:null,icon:null,onClick:function(){},disabled:!1};var f=p,O=(t(20),function(e){var n=e.label,t=e.value,r=e.setValue,c=e.placeholder,u=e.onKeyPressEnter,i=Object(a.useState)(!1),s=Object(l.a)(i,2),d=s[0],b=s[1],j=Object(a.useCallback)((function(e){r(e.target.value)})),p=Object(a.useCallback)((function(){b(!0)})),f=Object(a.useCallback)((function(){b(!1)})),O=Object(a.useCallback)((function(e){if(e||(e=window.event),"Enter"===(e.code||e.key)&&u)return u(),!1}));return Object(o.jsxs)("div",{className:"text-input"+(d?" active":"")+(t?" filled":""),children:[Object(o.jsx)("label",{children:n}),Object(o.jsx)("input",{type:"text",value:t,onChange:j,placeholder:c,onFocus:p,onBlur:f,required:"required",onKeyPress:O})]})});O.defaultProps={label:null,value:null,placeholder:null,onKeyPressEnter:null};var m=O,x="0.0.5",y="menu",v="lobby_pregame",g="join_lobby_pregame",h="character_selection",k="CLIENT_DATA",C=t(11),I=t.n(C)()(["https://project-bg.herokuapp.com/gun"]),w=function(e){for(var n,t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];(n=console).log.apply(n,[e].concat(a))},_=function(e,n){return new Promise((function(t){I.get(e).put(n,(function(n){w("Data "+e+" stored: ",n),t(n)}))}))},N=function(e){return new Promise((function(n){I.get(e).once((function(t){w("Data "+e+" read: ",t),n(t)}))}))},S=function(e,n){return new Promise((function(t){I.get(e).on((function(e,t,a,r){return n(e)}),!0),t()}))},D=function(e){return new Promise((function(n){I.get(e).off(),n()}))},P=function(){for(var e=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t=0;t<4;t++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")},K=function(){var e=Object(j.a)(b.a.mark((function e(n){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={key:P(),appVersion:x,creatorDeviceId:n.deviceId},e.next=3,_(t.key,t);case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),M=function(){var e=Object(j.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(n,{deleted:!0});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),T=function(){var e=Object(j.a)(b.a.mark((function e(n,t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(n,t);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(j.a)(b.a.mark((function e(n){var t,a,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.key,a=n.clientData,r=n.onCampaignChange,t&&4===t.length){e.next=3;break}return e.abrupt("return","The campaign key is not valid");case 3:return e.next=5,N(t);case 5:if((c=e.sent)&&c.key){e.next=8;break}return e.abrupt("return","The campaign does not exist");case 8:if(c.appVersion===x){e.next=10;break}return e.abrupt("return","The campaign has a different version");case 10:return G(a),r(c),e.next=14,S(t,r);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),B=function(){var e=Object(j.a)(b.a.mark((function e(n,t,a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(n);case 2:return e.next=4,N(n);case 4:if((null===(r=e.sent)||void 0===r?void 0:r.creatorDeviceId)!==t){e.next=10;break}return e.next=8,M(n);case 8:e.next=12;break;case 10:return e.next=12,U(n,a);case 12:case"end":return e.stop()}}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),G=function(e){if(e.playerId&&e.campaignKey){var n={};n[e.playerId+"_deviceId"]=e.deviceId,n[e.playerId+"_userName"]=e.userName,n[e.playerId+"_clientScene"]=e.clientScene,e.clientScene===h?(n[e.playerId+"_cursorX"]=e.cursor.x,n[e.playerId+"_cursorY"]=e.cursor.y,n[e.playerId+"_cursorHide"]=e.cursor.hide,n[e.playerId+"_cursorText"]=e.cursor.text):(n[e.playerId+"_cursorX"]=0,n[e.playerId+"_cursorY"]=0,n[e.playerId+"_cursorHide"]=!0,n[e.playerId+"_cursorText"]=null),T(e.campaignKey,n)}},U=function(e,n){if(n&&e){var t={};t[n+"_deviceId"]=null,t[n+"_userName"]=null,t[n+"_clientScene"]=null,t[n+"_cursorX"]=null,t[n+"_cursorY"]=null,t[n+"_cursorHide"]=null,t[n+"_cursorText"]=null,T(e,t)}},A=(t(27),function(e){var n=e.clientData,t=e.changeUserName,r=e.changeCampaignKey,c=e.changeClientScene,u=e.softResetClientData,i=e.mergeGameData,s=e.addToastMessage,d=Object(a.useState)(n.userName),p=Object(l.a)(d,2),O=p[0],y=p[1],h=Object(a.useCallback)(Object(j.a)(b.a.mark((function e(){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(O),e.next=3,K(n);case 3:return a=e.sent,e.next=6,Y({key:a.key,clientData:n,onCampaignChange:i});case 6:r(a.key),c(v);case 8:case"end":return e.stop()}}),e)}))),[t,O,n,s,i,r,c]),k=Object(a.useCallback)((function(){t(O),c(g)}),[t,O,c]),C=Object(a.useCallback)(Object(j.a)(b.a.mark((function e(){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(O),e.next=3,Y({key:n.campaignKey,clientData:n,onCampaignChange:i});case 3:(a=e.sent)?s(a):c(v);case 5:case"end":return e.stop()}}),e)}))),[t,O,n,i,c,s]),I=Object(a.useCallback)(Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(n.campaignKey,n.deviceId,n.playerId);case 2:u();case 3:case"end":return e.stop()}}),e)}))),[n.campaignKey,n.deviceId,n.playerId,u]);return Object(o.jsxs)("div",{id:"menu",children:[Object(o.jsx)(m,{label:"Name",value:O,setValue:y}),n.campaignKey&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(f,{text:"Continue campaign "+n.campaignKey,icon:"navigate_next",onClick:C}),Object(o.jsx)(f,{text:"Leave campaign "+n.campaignKey,icon:"logout",onClick:I})]}),!n.campaignKey&&Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(f,{text:"Create campaign",icon:"add",onClick:h,disabled:0===O.length}),Object(o.jsx)(f,{text:"Join campaign",icon:"login",onClick:k,disabled:0===O.length})]}),Object(o.jsx)("span",{className:"version",children:x})]})});A.defaultProps={};var E=A,R=(t(8),function(e){var n=e.color,t=e.userName,r=e.itsAMe,c=e.onSelectPlayer,u=Object(a.useMemo)((function(){return["player",n,t?null:"locked"].filter((function(e){return!!e})).join(" ")}),[n,t]),l=Object(a.useMemo)((function(){return t?r?t+" (you)":t:"Player "+n+" (bot)"}),[t,n,r]);return Object(o.jsxs)("div",{className:u,onClick:c,children:[t?Object(o.jsx)("span",{className:"icon material-icons-round",children:"face"}):Object(o.jsx)("span",{className:"icon material-icons-outlined",children:"smart_toy"}),Object(o.jsx)("span",{children:l})]})});R.defaultProps={userName:null};var V=R,H=function(e){var n=e.clientData,t=e.gameData,r=e.changePlayerId,c=e.changeClientScene,u=e.addToastMessage,l=Object(a.useCallback)(function(){var e=Object(j.a)(b.a.mark((function e(a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t[a+"_deviceId"]){e.next=2;break}return e.abrupt("return",u("error","Already taken"));case 2:return e.next=4,U(n.campaignKey,n.playerId);case 4:r(a);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[t,u,n.campaignKey,n.playerId,r]);return Object(o.jsxs)("div",{id:"pregame",children:[Object(o.jsxs)("div",{className:"lobby-key",children:["Lobby code:",Object(o.jsx)("span",{className:"selectable",children:n.campaignKey})]}),Object(o.jsx)(V,{color:"blue",userName:null===t||void 0===t?void 0:t.playerBlue_userName,itsAMe:(null===t||void 0===t?void 0:t.playerBlue_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerBlue")}}),Object(o.jsx)(V,{color:"red",userName:null===t||void 0===t?void 0:t.playerRed_userName,itsAMe:(null===t||void 0===t?void 0:t.playerRed_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerRed")}}),Object(o.jsx)(V,{color:"green",userName:null===t||void 0===t?void 0:t.playerGreen_userName,itsAMe:(null===t||void 0===t?void 0:t.playerGreen_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerGreen")}}),Object(o.jsx)(V,{color:"yellow",userName:null===t||void 0===t?void 0:t.playerYellow_userName,itsAMe:(null===t||void 0===t?void 0:t.playerYellow_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerYellow")}}),Object(o.jsx)(f,{text:"Back",icon:"arrow_back",onClick:function(){return c(y)}}),Object(o.jsx)(f,{text:"Start",icon:"play_arrow",onClick:function(){return c(h)}})]})};H.defaultProps={gameData:null};var J=H,X=(t(28),function(e){var n=e.clientData,t=(e.changeCampaignKey,e.changeClientScene),r=e.mergeGameData,c=e.addToastMessage,u=Object(a.useState)(""),i=Object(l.a)(u,2),s=i[0],d=i[1],p=Object(a.useCallback)(Object(j.a)(b.a.mark((function e(){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({key:s,clientData:n,onCampaignChange:r});case 2:(a=e.sent)?c("error",a):t(v);case 4:case"end":return e.stop()}}),e)}))),[s,n,r,t,c]),O=Object(a.useCallback)((function(e){(null===e||void 0===e?void 0:e.length)>4||d(e.toUpperCase())}),[]);return Object(o.jsxs)("div",{id:"join_pregame",children:[Object(o.jsx)(m,{label:"Lobby code",value:s,setValue:O,onKeyPressEnter:p}),Object(o.jsx)(f,{text:"Back",icon:"arrow_back",onClick:function(){return t(y)}}),Object(o.jsx)(f,{text:"Join campaign",icon:"login",onClick:p,disabled:4!==s.length})]})});X.defaultProps={};var F=X,L=(t(29),function(e){var n=e.changeClientScene;return Object(o.jsxs)("div",{id:"character_selection",children:[Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)(f,{text:"Back",icon:"arrow_back",onClick:function(){return n(v)}})]})});L.defaultProps={};var q=L,Q=(t(9),function(e){var n=e.playerId,t=e.cursorData,r=e.changeCursorX,c=e.changeCursorY,u=e.changeCursorHide,l=e.changeCursorUp,i=e.changeCursorDown,s=Object(a.useMemo)((function(){switch(n){case"playerBlue":return"blue";case"playerRed":return"red";case"playerGreen":return"green";case"playerYellow":return"yellow";default:return null}}),[n]),d=Object(a.useMemo)((function(){return["cursor",t.hide?"hidden":null,t.mouseDown?"down":null,t.mouseUp?"up":null,s].filter((function(e){return!!e})).join(" ")}),[s,t.hide,t.mouseDown,t.mouseUp]),b=Object(a.useCallback)((function(e){var n=e||window.event;r(n.x),c(n.y)}),[]),j=Object(a.useCallback)((function(){u(!1)}),[]),p=Object(a.useCallback)((function(){l(!1),u(!0)}),[]),f=Object(a.useCallback)((function(){l(!1),i(!0)}),[]),O=Object(a.useCallback)((function(){i(!1),l(!0)}),[]),m=Object(a.useCallback)((function(e){return e.preventDefault(),!1}),[]);return Object(a.useEffect)((function(){document.onmousemove=b,document.onmouseenter=j,document.onmouseleave=p,document.onmousedown=f,document.onmouseup=O,document.oncontextmenu=m})),Object(o.jsxs)("div",{className:d,style:{transform:"translate("+t.x+"px, "+t.y+"px)"},children:[Object(o.jsx)("div",{className:"goccia"}),Object(o.jsx)("div",{className:"text",children:t.text})]})});Q.defaultProps={playerId:null};var W=Q,Z=function(e){var n=e.playerId,t=e.gameData;if(!t||!t[n+"_userName"])return null;var r=Object(a.useMemo)((function(){switch(n){case"playerBlue":return"blue";case"playerRed":return"red";case"playerGreen":return"green";case"playerYellow":return"yellow";default:return null}}),[n]),c=Object(a.useMemo)((function(){return["cursor",t[n+"_cursorHide"]?"hidden":null,r].filter((function(e){return!!e})).join(" ")}),[r,t[n+"_cursorHide"]]);return Object(o.jsxs)("div",{className:c,style:{transform:"translate("+t[n+"_cursorX"]+"px, "+t[n+"_cursorY"]+"px)"},children:[Object(o.jsx)("div",{className:"goccia"}),Object(o.jsx)("div",{className:"text",children:t[n+"_cursorText"]})]})};Z.defaultProps={playerId:null,gameData:null};var z=Z,$=(t(30),function(e){var n=e.messages;return Object(o.jsx)("div",{id:"toast_message_container",children:null===n||void 0===n?void 0:n.map((function(e,n){return Object(o.jsxs)("div",{className:"toast-message "+e.type,children:["error"===e.type&&Object(o.jsx)("span",{className:"icon material-icons-round",children:"priority_high"}),Object(o.jsx)("span",{className:"text",children:e.text})]},n)}))})});$.defaultProps={};var ee=$,ne=(t(31),function(){var e=Object(a.useState)(0),n=Object(l.a)(e,2),t=(n[0],n[1]),r=Object(a.useState)([]),c=Object(l.a)(r,2),i=c[0],d=c[1],b=Object(a.useCallback)((function(e){d((function(n){var t=n.findIndex((function(n){return n.id===e}));return t<0||n.splice(t,1),n}))}),[]),j=Object(a.useCallback)((function(e,n){var a=0;t((function(e){return a=e+1})),d((function(t){return t.push({id:a,type:e,text:n}),t})),setTimeout((function(){return b(a)}),3e3)}),[b]),p=Object(a.useState)((function(){var e=JSON.parse(localStorage.getItem(k));if((null===e||void 0===e?void 0:e.appVersion)===x)return Object(u.a)(Object(u.a)({},e),{},{clientScene:y});var n={appVersion:x,deviceId:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)})),clientScene:y,userName:"",campaignKey:null,playerId:null,cursor:{x:0,y:0,mouseUp:!1,mouseDown:!1,hide:!0,text:""}};return e&&e.appVersion!==x&&e.deviceId?Object(u.a)(Object(u.a)({},n),{},{deviceId:e.deviceId,userName:e.userName}):n})),f=Object(l.a)(p,2),O=f[0],m=f[1];Object(a.useEffect)((function(){G(O),localStorage.setItem(k,JSON.stringify(O))}),[O]);var C=Object(a.useCallback)((function(){m((function(e){return Object(u.a)(Object(u.a)({},e),{},{clientScene:y,campaignKey:null,playerId:null})}))}),[]),I=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{clientScene:e})}))}),[]),w=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{userName:e})}))}),[]),_=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{campaignKey:e})}))}),[]),N=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{playerId:e})}))}),[]),S=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{cursor:Object(u.a)(Object(u.a)({},n.cursor),{},{x:e,hide:!1})})}))}),[]),D=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{cursor:Object(u.a)(Object(u.a)({},n.cursor),{},{y:e,hide:!1})})}))}),[]),P=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{cursor:Object(u.a)(Object(u.a)({},n.cursor),{},{mouseUp:e})})}))}),[]),K=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{cursor:Object(u.a)(Object(u.a)({},n.cursor),{},{mouseDown:e})})}))}),[]),M=Object(a.useCallback)((function(e){m((function(n){return Object(u.a)(Object(u.a)({},n),{},{cursor:Object(u.a)(Object(u.a)({},n.cursor),{},{hide:e})})}))}),[]),T=Object(a.useState)(null),Y=Object(l.a)(T,2),U=Y[0],A=Y[1],R=Object(a.useCallback)((function(){B(O.campaignKey,O.deviceId,O.playerId),C(),A(null)}),[O.campaignKey,O.deviceId,O.playerId,C]),V=Object(a.useCallback)((function(e){!0!==(null===e||void 0===e?void 0:e.deleted)?A((function(n){return Object(u.a)(Object(u.a)({},n),e)})):R()}),[R]);return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(s,{}),y===O.clientScene&&Object(o.jsx)(E,{clientData:O,changeUserName:w,changeCampaignKey:_,changeClientScene:I,softResetClientData:C,mergeGameData:V,addToastMessage:j}),v===O.clientScene&&Object(o.jsx)(J,{clientData:O,gameData:U,changePlayerId:N,changeClientScene:I,addToastMessage:j}),g===O.clientScene&&Object(o.jsx)(F,{clientData:O,changeCampaignKey:_,changeClientScene:I,mergeGameData:V,addToastMessage:j}),h===O.clientScene&&Object(o.jsx)(q,{changeClientScene:I}),h===O.clientScene&&"playerBlue"!==O.playerId&&Object(o.jsx)(z,{playerId:"playerBlue",gameData:U}),h===O.clientScene&&"playerRed"!==O.playerId&&Object(o.jsx)(z,{playerId:"playerRed",gameData:U}),h===O.clientScene&&"playerGreen"!==O.playerId&&Object(o.jsx)(z,{playerId:"playerGreen",gameData:U}),h===O.clientScene&&"playerYellow"!==O.playerId&&Object(o.jsx)(z,{playerId:"playerYellow",gameData:U}),Object(o.jsx)(ee,{messages:i}),O.cursor&&Object(o.jsx)(W,{playerId:O.playerId,cursorData:O.cursor,changeCursorX:S,changeCursorY:D,changeCursorUp:P,changeCursorDown:K,changeCursorHide:M})]})});c.a.render(Object(o.jsx)(ne,{}),document.getElementById("app"))}],[[32,1,2]]]);
//# sourceMappingURL=main.bb5abedb.chunk.js.map