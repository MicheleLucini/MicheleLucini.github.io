(this["webpackJsonpproject-bg"]=this["webpackJsonpproject-bg"]||[]).push([[0],[,,,,,,function(e,n,t){},function(e,n,t){},,,,,,,function(e,n,t){},,function(e,n,t){},function(e,n,t){},,,,,,function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=23},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var c=t(1),r=t(8),a=t.n(r),l=t(2),o=t(3),u=(t(14),t(0)),i=function(e){e.gamePhase;return Object(u.jsx)("div",{id:"bg",children:Object(u.jsx)("div",{className:"noise"})})};i.defaultProps={gamePhase:null};var s=i,b=(t(16),function(e){var n=e.text,t=e.icon,c=e.onClick,r=e.disabled;return Object(u.jsxs)("button",{className:"simple-button"+(r?" disabled":""),type:"button",onClick:c,children:[t&&Object(u.jsx)("span",{className:"material-icons-round",children:t}),n&&n]})});b.defaultProps={text:null,icon:null,onClick:function(){},disabled:!1};var d=b,j=(t(17),function(e){var n=e.label,t=e.value,r=e.setValue,a=e.placeholder,l=e.onKeyPressEnter,i=Object(c.useState)(!1),s=Object(o.a)(i,2),b=s[0],d=s[1],j=Object(c.useCallback)((function(e){r(e.target.value)})),f=Object(c.useCallback)((function(){d(!0)})),O=Object(c.useCallback)((function(){d(!1)})),y=Object(c.useCallback)((function(e){if(e||(e=window.event),"Enter"===(e.code||e.key)&&l)return l(),!1}));return Object(u.jsxs)("div",{className:"text-input"+(b?" active":"")+(t?" filled":""),children:[Object(u.jsx)("label",{children:n}),Object(u.jsx)("input",{type:"text",value:t,onChange:j,placeholder:a,onFocus:f,onBlur:O,required:"required",onKeyPress:y})]})});j.defaultProps={label:null,value:null,placeholder:null,onKeyPressEnter:null};var f=j,O="0.0.2",y="menu",p="lobby_pregame",x="join_lobby_pregame",m="character_selection",g="CLIENT_DATA",v=t(9),h=function(){for(var e=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t=0;t<4;t++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")},C=t.n(v)()(["https://project-bg.herokuapp.com/gun"]),k=!1,I=function(e,n,t,c){if(console.log("connected? ",k),k&&_(k,n),console.log("key? ",e),!e||4!==e.length)return!1;!function(e,n,t){C.get(e).once((function(e){e&&e.key?(console.log("the game "+e.key+" exists",e),n()):(console.error("The game "+e.key+" doesn't exists.",e),t())}))}(e,(function(){!function(e,n){C.get(e).once((function(e){console.log("game downloaded: ",e),n(e)}))}(e,t),function(e,n){C.get(e).on((function(e,t,c,r){n(e)}),!0)}(e,t),k=e,c()}),(function(){}))},_=function(e,n){e&&(C.get(e).off(),k=null,function(e,n,t){C.get(e).once((function(e){e&&e.creatorDeviceId===n.deviceId&&(console.log("the game "+e.key+" is mine",e),t())}))}(e,n,(function(){return function(e){C.get(e).put({key:null})}(e)})))},N=(t(24),function(e){var n=e.clientData,t=e.changeUserName,r=e.changeCurrentLobbyKey,a=e.changeClientScene,l=e.mergeGameData,i=Object(c.useState)(n.userName),s=Object(o.a)(i,2),b=s[0],j=s[1],y=Object(c.useCallback)((function(){t(b);var e=function(e){var n={key:h(),appVersion:O,creatorDeviceId:e.deviceId};return C.get(n.key).put(n,(function(e){return console.log("created game: ",e)})),n}(n);I(e.key,n,l,(function(){r(e.key),a(p)}))}),[b,n,l]),m=Object(c.useCallback)((function(){t(b),a(x)}),[b]),g=Object(c.useCallback)((function(){t(b),I(n.currentLobbyKey,n,l,(function(){a(p)}))}),[b,n,l]),v=Object(c.useCallback)((function(){_(n.currentLobbyKey,n),r(null)}),[n]);return Object(u.jsxs)("div",{id:"menu",children:[Object(u.jsx)(f,{label:"Name",value:b,setValue:j}),n.currentLobbyKey&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(d,{text:"Continue campaign "+n.currentLobbyKey,icon:"navigate_next",onClick:g}),Object(u.jsx)(d,{text:"Leave campaign "+n.currentLobbyKey,icon:"logout",onClick:v})]}),!n.currentLobbyKey&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(d,{text:"Create campaign",icon:"add",onClick:y,disabled:0===b.length}),Object(u.jsx)(d,{text:"Join campaign",icon:"login",onClick:m,disabled:0===b.length})]})]})});N.defaultProps={};var S=N,D=(t(6),function(e){var n=e.color,t=e.userName,r=e.itsAMe,a=e.onSelectPlayer,l=Object(c.useMemo)((function(){return["player",n,t?null:"locked"].filter((function(e){return!!e})).join(" ")}),[n,t]),o=Object(c.useMemo)((function(){return t?r?t+" (you)":t:"Player "+n+" (bot)"}),[t,n,r]);return Object(u.jsxs)("div",{className:l,onClick:a,children:[t?Object(u.jsx)("span",{className:"icon material-icons-round",children:"face"}):Object(u.jsx)("span",{className:"icon material-icons-outlined",children:"smart_toy"}),Object(u.jsx)("span",{children:o})]})});D.defaultProps={userName:null};var w=D,P=function(e){var n=e.clientData,t=e.gameData,r=e.changePlayerId,a=e.changeClientScene,l=Object(c.useCallback)((function(e){t[e+"_deviceId"]||(!function(e){if(k&&e.playerId){var n={};n[e.playerId+"_deviceId"]=null,n[e.playerId+"_userName"]=null,n[e.playerId+"_clientScene"]=null,n[e.playerId+"_cursorX"]=null,n[e.playerId+"_cursorY"]=null,n[e.playerId+"_cursorHide"]=null,n[e.playerId+"_cursorText"]=null,C.get(k).put(n)}}(n),r(e))}),[n]);return Object(u.jsxs)("div",{id:"pregame",children:[Object(u.jsxs)("div",{className:"lobby-key",children:["Lobby code:",Object(u.jsx)("span",{className:"selectable",children:n.currentLobbyKey})]}),Object(u.jsx)(w,{color:"blue",userName:null===t||void 0===t?void 0:t.playerBlue_userName,itsAMe:(null===t||void 0===t?void 0:t.playerBlue_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerBlue")}}),Object(u.jsx)(w,{color:"red",userName:null===t||void 0===t?void 0:t.playerRed_userName,itsAMe:(null===t||void 0===t?void 0:t.playerRed_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerRed")}}),Object(u.jsx)(w,{color:"green",userName:null===t||void 0===t?void 0:t.playerGreen_userName,itsAMe:(null===t||void 0===t?void 0:t.playerGreen_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerGreen")}}),Object(u.jsx)(w,{color:"yellow",userName:null===t||void 0===t?void 0:t.playerYellow_userName,itsAMe:(null===t||void 0===t?void 0:t.playerYellow_deviceId)===n.deviceId,onSelectPlayer:function(){return l("playerYellow")}}),Object(u.jsx)(d,{text:"Back",icon:"arrow_back",onClick:function(){return a(y)}}),Object(u.jsx)(d,{text:"Start",icon:"play_arrow",onClick:function(){return a(m)}})]})};P.defaultProps={gameData:null};var L=P,K=(t(25),function(e){var n=e.clientData,t=e.changeCurrentLobbyKey,r=e.changeClientScene,a=e.mergeGameData,l=Object(c.useState)(""),i=Object(o.a)(l,2),s=i[0],b=i[1],j=Object(c.useCallback)((function(){I(s,n,a,(function(){t(s),r(p)}))}),[s,n,a]),O=Object(c.useCallback)((function(e){b(e.toUpperCase())}),[]);return Object(u.jsxs)("div",{id:"join_pregame",children:[Object(u.jsx)(f,{label:"Lobby code",value:s,setValue:O,onKeyPressEnter:j}),Object(u.jsx)(d,{text:"Back",icon:"arrow_back",onClick:function(){return r(y)}}),Object(u.jsx)(d,{text:"Join campaign",icon:"login",onClick:j,disabled:4!==s.length})]})});K.defaultProps={};var M=K,B=(t(26),function(e){var n=e.changeClientScene;return Object(u.jsxs)("div",{id:"character_selection",children:[Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)("div",{}),Object(u.jsx)(d,{text:"Back",icon:"arrow_back",onClick:function(){return n(p)}})]})});B.defaultProps={};var Y=B,E=(t(7),function(e){var n=e.playerId,t=e.cursorData,r=e.changeCursorX,a=e.changeCursorY,l=e.changeCursorHide,o=e.changeCursorUp,i=e.changeCursorDown,s=Object(c.useMemo)((function(){switch(n){case"playerBlue":return"blue";case"playerRed":return"red";case"playerGreen":return"green";case"playerYellow":return"yellow";default:return null}}),[n]),b=Object(c.useMemo)((function(){return["cursor",t.hide?"hidden":null,t.mouseDown?"down":null,t.mouseUp?"up":null,s].filter((function(e){return!!e})).join(" ")}),[s,t.hide,t.mouseDown,t.mouseUp]),d=Object(c.useCallback)((function(e){var n=e||window.event;r(n.x),a(n.y)}),[]),j=Object(c.useCallback)((function(){l(!1)}),[]),f=Object(c.useCallback)((function(){o(!1),l(!0)}),[]),O=Object(c.useCallback)((function(){o(!1),i(!0)}),[]),y=Object(c.useCallback)((function(){i(!1),o(!0)}),[]),p=Object(c.useCallback)((function(e){return e.preventDefault(),!1}),[]);return Object(c.useEffect)((function(){document.onmousemove=d,document.onmouseenter=j,document.onmouseleave=f,document.onmousedown=O,document.onmouseup=y,document.oncontextmenu=p})),Object(u.jsxs)("div",{className:b,style:{transform:"translate("+t.x+"px, "+t.y+"px)"},children:[Object(u.jsx)("div",{className:"goccia"}),Object(u.jsx)("div",{className:"text",children:t.text})]})});E.defaultProps={playerId:null};var G=E,U=function(e){var n=e.playerId,t=e.gameData;if(!t||!t[n+"_userName"])return null;var r=Object(c.useMemo)((function(){switch(n){case"playerBlue":return"blue";case"playerRed":return"red";case"playerGreen":return"green";case"playerYellow":return"yellow";default:return null}}),[n]),a=Object(c.useMemo)((function(){return["cursor",t[n+"_cursorHide"]?"hidden":null,r].filter((function(e){return!!e})).join(" ")}),[r,t[n+"_cursorHide"]]);return Object(u.jsxs)("div",{className:a,style:{transform:"translate("+t[n+"_cursorX"]+"px, "+t[n+"_cursorY"]+"px)"},children:[Object(u.jsx)("div",{className:"goccia"}),Object(u.jsx)("div",{className:"text",children:t[n+"_cursorText"]})]})};U.defaultProps={playerId:null,gameData:null};var A=U,J=(t(27),function(){var e=Object(c.useState)((function(){var e=JSON.parse(localStorage.getItem(g));if((null===e||void 0===e?void 0:e.appVersion)===O)return Object(l.a)(Object(l.a)({},e),{},{clientScene:y});var n={appVersion:O,deviceId:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)})),clientScene:y,userName:"",currentLobbyKey:null,playerId:null,cursor:{x:0,y:0,mouseUp:!1,mouseDown:!1,hide:!0,text:""}};return localStorage.setItem(g,JSON.stringify(n)),n})),n=Object(o.a)(e,2),t=n[0],r=n[1];Object(c.useEffect)((function(){!function(e){if(k&&e.playerId){var n={};n[e.playerId+"_deviceId"]=e.deviceId,n[e.playerId+"_userName"]=e.userName,n[e.playerId+"_clientScene"]=e.clientScene,e.clientScene===m&&(n[e.playerId+"_cursorX"]=e.cursor.x,n[e.playerId+"_cursorY"]=e.cursor.y,n[e.playerId+"_cursorHide"]=e.cursor.hide,n[e.playerId+"_cursorText"]=e.cursor.text),C.get(k).put(n)}}(t),localStorage.setItem(g,JSON.stringify(t))}),[t]);var a=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{clientScene:e})}))}),[]),i=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{userName:e})}))}),[]),b=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{currentLobbyKey:e})}))}),[]),d=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{playerId:e})}))}),[]),j=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{x:e,hide:!1})})}))}),[]),f=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{y:e,hide:!1})})}))}),[]),v=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{mouseUp:e})})}))}),[]),h=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{mouseDown:e})})}))}),[]),I=Object(c.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{hide:e})})}))}),[]),_=Object(c.useState)(null),N=Object(o.a)(_,2),D=N[0],w=N[1],P=Object(c.useCallback)((function(e){w((function(n){return Object(l.a)(Object(l.a)({},n),e)}))}),[]);return Object(c.useEffect)((function(){console.log("gameData changed: ",Object(l.a)({},D))}),[D]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(s,{}),y===t.clientScene&&Object(u.jsx)(S,{clientData:t,changeUserName:i,changeCurrentLobbyKey:b,changeClientScene:a,mergeGameData:P}),p===t.clientScene&&Object(u.jsx)(L,{clientData:t,gameData:D,changePlayerId:d,changeClientScene:a}),x===t.clientScene&&Object(u.jsx)(M,{clientData:t,changeCurrentLobbyKey:b,changeClientScene:a,mergeGameData:P}),m===t.clientScene&&Object(u.jsx)(Y,{changeClientScene:a}),m===t.clientScene&&"playerBlue"!==t.playerId&&Object(u.jsx)(A,{playerId:"playerBlue",gameData:D}),m===t.clientScene&&"playerRed"!==t.playerId&&Object(u.jsx)(A,{playerId:"playerRed",gameData:D}),m===t.clientScene&&"playerGreen"!==t.playerId&&Object(u.jsx)(A,{playerId:"playerGreen",gameData:D}),m===t.clientScene&&"playerYellow"!==t.playerId&&Object(u.jsx)(A,{playerId:"playerYellow",gameData:D}),t.cursor&&Object(u.jsx)(G,{playerId:t.playerId,cursorData:t.cursor,changeCursorX:j,changeCursorY:f,changeCursorUp:v,changeCursorDown:h,changeCursorHide:I})]})});a.a.render(Object(u.jsx)(J,{}),document.getElementById("app"))}],[[28,1,2]]]);
//# sourceMappingURL=main.f8123158.chunk.js.map