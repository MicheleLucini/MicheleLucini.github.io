(this["webpackJsonpproject-bg"]=this["webpackJsonpproject-bg"]||[]).push([[0],[,,,,,,function(e,n,c){},function(e,n,c){},,,,,,,function(e,n,c){},,function(e,n,c){},function(e,n,c){},function(e,n,c){},,,,,,function(e,n){function c(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}c.keys=function(){return[]},c.resolve=c,e.exports=c,c.id=24},function(e,n,c){},function(e,n,c){},function(e,n,c){},function(e,n,c){"use strict";c.r(n);var t=c(1),r=c(8),a=c.n(r),l=c(2),u=c(3),o=(c(14),c(0)),s=function(e){e.gamePhase;return Object(o.jsx)("div",{id:"bg",children:Object(o.jsx)("div",{className:"noise"})})};s.defaultProps={gamePhase:null};var i=s,d=(c(16),function(e){var n=e.text,c=e.icon,t=e.onClick,r=e.disabled;return Object(o.jsxs)("button",{className:"simple-button"+(r?" disabled":""),type:"button",onClick:t,children:[c&&Object(o.jsx)("span",{className:"material-icons-round",children:c}),n&&n]})});d.defaultProps={text:null,icon:null,onClick:function(){},disabled:!1};var b=d,j=(c(17),function(e){var n=e.label,c=e.value,r=e.setValue,a=e.placeholder,l=e.onKeyPressEnter,s=Object(t.useState)(!1),i=Object(u.a)(s,2),d=i[0],b=i[1],j=Object(t.useCallback)((function(e){r(e.target.value)})),O=Object(t.useCallback)((function(){b(!0)})),p=Object(t.useCallback)((function(){b(!1)})),y=Object(t.useCallback)((function(e){if(e||(e=window.event),"Enter"===(e.code||e.key)&&l)return l(),!1}));return Object(o.jsxs)("div",{className:"text-input"+(d?" active":"")+(c?" filled":""),children:[Object(o.jsx)("label",{children:n}),Object(o.jsx)("input",{type:"text",value:c,onChange:j,placeholder:a,onFocus:O,onBlur:p,required:"required",onKeyPress:y})]})});j.defaultProps={label:null,value:null,placeholder:null,onKeyPressEnter:null};var O=j,p="0.0.1",y="menu",f="lobby_pregame",x="join_lobby_pregame",m="character_selection",v="CLIENT_DATA",h=(c(18),function(e){var n=e.userName,c=e.changeUserName,r=e.changeClientScene,a=Object(t.useState)(n),l=Object(u.a)(a,2),s=l[0],i=l[1],d=Object(t.useCallback)((function(){c(s),r(f)}),[s]),j=Object(t.useCallback)((function(){c(s),r(x)}),[s]);return Object(o.jsxs)("div",{id:"menu",children:[Object(o.jsx)(O,{label:"Name",value:s,setValue:i}),Object(o.jsx)(b,{text:"Create campaign",icon:"add",onClick:d,disabled:0===s.length}),Object(o.jsx)(b,{text:"Join campaign",icon:"login",onClick:j,disabled:0===s.length})]})});h.defaultProps={};var g=h,C=(c(6),function(e){var n=e.color,c=e.playerId,r=e.userName,a=e.itsAMe,l=e.changePlayerId,u=Object(t.useMemo)((function(){return["player",n,r?null:"locked"].filter((function(e){return!!e})).join(" ")}),[n,r]),s=Object(t.useMemo)((function(){return r?a?r+" (you)":r:"Player "+n+" (bot)"}),[r,n,a]),i=Object(t.useCallback)((function(){r||l(c)}),[r,c]);return Object(o.jsxs)("div",{className:u,onClick:i,children:[r?Object(o.jsx)("span",{className:"icon material-icons-round",children:"face"}):Object(o.jsx)("span",{className:"icon material-icons-outlined",children:"smart_toy"}),Object(o.jsx)("span",{children:s})]})});C.defaultProps={userName:null};var I=C,k=function(e){var n=e.clientData,c=e.gameData,t=e.changePlayerId,r=e.changeClientScene;return Object(o.jsxs)("div",{id:"pregame",children:[Object(o.jsxs)("div",{className:"lobby-key",children:["Lobby code:",Object(o.jsx)("span",{className:"selectable",children:n.currentLobbyKey})]}),Object(o.jsx)(I,{color:"blue",playerId:"playerBlue",userName:null===c||void 0===c?void 0:c.playerBlue_userName,itsAMe:(null===c||void 0===c?void 0:c.playerBlue_deviceId)===n.deviceId,changePlayerId:t}),Object(o.jsx)(I,{color:"red",playerId:"playerRed",userName:null===c||void 0===c?void 0:c.playerRed_userName,itsAMe:(null===c||void 0===c?void 0:c.playerRed_deviceId)===n.deviceId,changePlayerId:t}),Object(o.jsx)(I,{color:"green",playerId:"playerGreen",userName:null===c||void 0===c?void 0:c.playerGreen_userName,itsAMe:(null===c||void 0===c?void 0:c.playerGreen_deviceId)===n.deviceId,changePlayerId:t}),Object(o.jsx)(I,{color:"yellow",playerId:"playerYellow",userName:null===c||void 0===c?void 0:c.playerYellow_userName,itsAMe:(null===c||void 0===c?void 0:c.playerYellow_deviceId)===n.deviceId,changePlayerId:t}),Object(o.jsx)(b,{text:"Back",icon:"arrow_back",onClick:function(){return r(y)}}),Object(o.jsx)(b,{text:"Start",icon:"play_arrow",onClick:function(){return r(m)}})]})};k.defaultProps={gameData:null};var N=k,_=c(9),S=function(){for(var e=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=0;c<4;c++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")},w=c.n(_)()(["https://project-bg.herokuapp.com/gun"]),D=function(e){if(e.playerId){var n={};n[e.playerId+"_deviceId"]=e.deviceId,n[e.playerId+"_userName"]=e.userName,n[e.playerId+"_clientScene"]=e.clientScene,n[e.playerId+"_cursorX"]=e.cursor.x,n[e.playerId+"_cursorY"]=e.cursor.y,n[e.playerId+"_cursorHide"]=e.cursor.hide,n[e.playerId+"_cursorText"]=e.cursor.text,w.get(e.currentLobbyKey).put(n,(function(e){}))}},P=(c(25),function(e){var n=e.changeCurrentLobbyKey,c=e.changeClientScene,r=Object(t.useState)(""),a=Object(u.a)(r,2),l=a[0],s=a[1],i=Object(t.useCallback)((function(){4===l.length&&(n(l),c(f))}),[l]),d=Object(t.useCallback)((function(e){s(e.toUpperCase())}),[]);return Object(o.jsxs)("div",{id:"join_pregame",children:[Object(o.jsx)(O,{label:"Lobby code",value:l,setValue:d,onKeyPressEnter:i}),Object(o.jsx)(b,{text:"Back",icon:"arrow_back",onClick:function(){return c(y)}}),Object(o.jsx)(b,{text:"Join campaign",icon:"login",onClick:i,disabled:4!==l.length})]})});P.defaultProps={};var K=P,L=(c(26),function(e){var n=e.changeClientScene;return Object(o.jsxs)("div",{id:"character_selection",children:[Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{}),Object(o.jsx)(b,{text:"Back",icon:"arrow_back",onClick:function(){return n(f)}})]})});L.defaultProps={};var M=L,B=(c(7),function(e){var n=e.playerId,c=e.cursorData,r=e.changeCursorX,a=e.changeCursorY,l=e.changeCursorHide,u=e.changeCursorUp,s=e.changeCursorDown,i=Object(t.useMemo)((function(){switch(n){case"playerBlue":return"blue";case"playerRed":return"red";case"playerGreen":return"green";case"playerYellow":return"yellow";default:return null}}),[n]),d=Object(t.useMemo)((function(){return[c.hide?"hidden":null,c.mouseDown?"down":null,c.mouseUp?"up":null,i].filter((function(e){return!!e})).join(" ")}),[i,c.hide,c.mouseDown,c.mouseUp]),b=Object(t.useCallback)((function(e){var n=e||window.event;r(n.x),a(n.y)}),[]),j=Object(t.useCallback)((function(){l(!1)}),[]),O=Object(t.useCallback)((function(){u(!1),l(!0)}),[]),p=Object(t.useCallback)((function(){u(!1),s(!0)}),[]),y=Object(t.useCallback)((function(){s(!1),u(!0)}),[]),f=Object(t.useCallback)((function(e){return e.preventDefault(),!1}),[]);return Object(t.useEffect)((function(){document.onmousemove=b,document.onmouseenter=j,document.onmouseleave=O,document.onmousedown=p,document.onmouseup=y,document.oncontextmenu=f})),Object(o.jsxs)("div",{id:"cursor",className:d,style:{transform:"translate("+c.x+"px, "+c.y+"px)"},children:[Object(o.jsx)("div",{className:"cursor"}),Object(o.jsx)("div",{className:"text",children:c.text})]})});B.defaultProps={playerId:null};var E=B,Y=function(e){var n=e.playerId,c=e.gameData;if(!c||!c[n+"_userName"])return null;var r=Object(t.useMemo)((function(){switch(n){case"playerBlue":return"blue";case"playerRed":return"red";case"playerGreen":return"green";case"playerYellow":return"yellow";default:return null}}),[n]),a=Object(t.useMemo)((function(){return[c[n+"_cursorHide"]?"hidden":null,r].filter((function(e){return!!e})).join(" ")}),[r,c[n+"_cursorHide"]]);return Object(o.jsxs)("div",{className:a,style:{transform:"translate("+c[n+"_cursorX"]+"px, "+c[n+"_cursorY"]+"px)"},children:[Object(o.jsx)("div",{className:"cursor"}),Object(o.jsx)("div",{className:"text",children:c[n+"_cursorText"]})]})};Y.defaultProps={playerId:null,gameData:null};var U=Y,A=(c(27),function(){var e=Object(t.useState)((function(){var e=JSON.parse(localStorage.getItem(v));if((null===e||void 0===e?void 0:e.appVersion)===p)return e;var n={appVersion:p,deviceId:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)})),clientScene:y,userName:"",currentLobbyKey:S(),playerId:null,cursor:{x:0,y:0,mouseUp:!1,mouseDown:!1,hide:!0,text:""}};return localStorage.setItem(v,JSON.stringify(n)),n})),n=Object(u.a)(e,2),c=n[0],r=n[1];Object(t.useEffect)((function(){D(c),localStorage.setItem(v,JSON.stringify(c))}),[c]);var a=Object(t.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{clientScene:e})}))}),[]),s=Object(t.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{userName:e})}))}),[]),d=Object(t.useCallback)((function(e){r((function(n){var c;return c=n.currentLobbyKey,w.get(c).off(),Object(l.a)(Object(l.a)({},n),{},{currentLobbyKey:e})}))}),[]),b=Object(t.useCallback)((function(e){r((function(n){return function(e){var n={};n[e.playerId+"_deviceId"]=null,n[e.playerId+"_userName"]=null,n[e.playerId+"_clientScene"]=null,n[e.playerId+"_cursorX"]=null,n[e.playerId+"_cursorY"]=null,n[e.playerId+"_cursorHide"]=null,n[e.playerId+"_cursorText"]=null,w.get(e.currentLobbyKey).put(n,(function(e){}))}(n),Object(l.a)(Object(l.a)({},n),{},{playerId:e})}))}),[]),j=Object(t.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{x:e,hide:!1})})}))}),[]),O=Object(t.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{y:e,hide:!1})})}))}),[]),h=Object(t.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{mouseUp:e})})}))}),[]),C=Object(t.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{mouseDown:e})})}))}),[]),I=Object(t.useCallback)((function(e){r((function(n){return Object(l.a)(Object(l.a)({},n),{},{cursor:Object(l.a)(Object(l.a)({},n.cursor),{},{hide:e})})}))}),[]),k=Object(t.useState)(null),_=Object(u.a)(k,2),P=_[0],L=_[1],B=Object(t.useCallback)((function(e){L((function(n){return Object(l.a)(Object(l.a)({},n),e)}))}),[]);return Object(t.useEffect)((function(){null!==c.currentLobbyKey&&""!==c.currentLobbyKey&&function(e,n){w.get(e.currentLobbyKey).on((function(e,c,t,r){n(e)}),!0),D(e)}(c,B)}),[c.currentLobbyKey]),Object(t.useEffect)((function(){console.log("gameData changed: ",Object(l.a)({},P))}),[P]),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(i,{}),y===c.clientScene&&Object(o.jsx)(g,{userName:c.userName,changeUserName:s,changeClientScene:a}),f===c.clientScene&&Object(o.jsx)(N,{clientData:c,gameData:P,changePlayerId:b,changeClientScene:a}),x===c.clientScene&&Object(o.jsx)(K,{changeCurrentLobbyKey:d,changeClientScene:a}),m===c.clientScene&&Object(o.jsx)(M,{changeClientScene:a}),m===c.clientScene&&"playerBlue"!==c.playerId&&Object(o.jsx)(U,{playerId:"playerBlue",gameData:P}),m===c.clientScene&&"playerRed"!==c.playerId&&Object(o.jsx)(U,{playerId:"playerRed",gameData:P}),m===c.clientScene&&"playerGreen"!==c.playerId&&Object(o.jsx)(U,{playerId:"playerGreen",gameData:P}),m===c.clientScene&&"playerYellow"!==c.playerId&&Object(o.jsx)(U,{playerId:"playerYellow",gameData:P}),c.cursor&&Object(o.jsx)(E,{playerId:c.playerId,cursorData:c.cursor,changeCursorX:j,changeCursorY:O,changeCursorUp:h,changeCursorDown:C,changeCursorHide:I})]})});a.a.render(Object(o.jsx)(A,{}),document.getElementById("app"))}],[[28,1,2]]]);
//# sourceMappingURL=main.4345d48a.chunk.js.map